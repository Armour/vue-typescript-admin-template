{
  "meta": {
    "ranking": { "title": "讲者排名", "type": "number" },
    "avatar_url": { "title": "讲者头像", "type": "image",
      "upload": {
        "width": 300, "height": 300
      },
      "crops": ["avatar_phone_jcrop"]
    },
    "avatar_phone_jcrop": { "title": "头像iphone参数", "type": "short" },
    "cover": { "title": "讲者照片", "type": "image",
      "upload": {
        "action": "https://cdn.yixi.tv/almond/"
      }
    },
    "speechcategory": {
      "title": "分类名称", "type": "select",
      "options": []
    },
    "name": { "title": "讲者姓名", "type": "short" },
    "scene_type": {
      "title": "场次名称", "type": "select",
      "options": [
        { "value": 0, "label": "无" },
        { "value": 1, "label": "日场" },
        { "value": 2, "label": "夜场" },
        { "value": 3, "label": "单场" }
      ]
    },
    "is_valid": {
      "title": "状态",
      "type": "select",
      "options": [
        { "value": 1, "label": "已发布" },
        { "value": 0, "label": "未发布" }
      ]
    },
    "created": { "title": "创建时间", "type": "date" },
    "intro": { "title": "讲者简介", "type": "long" },
    "id": { "title": "id", "type": "short" },
    "periods": { "title": "期数", "type": "number" },
    "describe": { "title": "讲者详细介绍", "type": "rich" },
    "quotations": { "title": "讲者语录", "type": "rich" }
  },
  "created": {
    "actions": [
      "retrieve" 
    ]
  },
  "filter": {
    "buttons": [
      {
        "label": "搜索", 
        "type": "primary", 
        "action": "retrieve"
      }
    ], 
    "values": {
      "name": "", 
      "is_valid": ""
    }
  }, 
  "actions": [
    {
      "label": "新建", 
      "type": "primary", 
      "action": "showCreateDialog"
    }
  ], 
  "table": {
    "columns": [
      {
        "key": "ranking", 
        "type": "link", 
        "action": "showUpdateDialog"
      }, 
      {
        "key": "name", 
        "type": "link", 
        "action": "showUpdateDialog"
      }, 
      {
        "key": "avatar_url"
      }, 
      {
        "key": "periods"
      }, 
      {
        "key": "scene_type"
      }, 
      {
        "key": "speechcategory"
      }, 
      {
        "key": "intro", 
        "width": 500
      }, 
      {
        "type": "action", 
        "title": "排序", 
        "width": 100, 
        "actions": [
          {
            "icon": "el-icon-top", 
            "type": "primary", 
            "circle": true, 
            "action": "upHandler"
          }, 
          {
            "icon": "el-icon-bottom", 
            "type": "primary", 
            "circle": true, 
            "action": "downHandler"
          }
        ]
      }, 
      {
        "key": "is_valid"
      }, 
      {
        "type": "action", 
        "width": 250, 
        "title": "操作", 
        "actions": [
          {
            "label": "编辑", 
            "type": "primary", 
            "action": "showUpdateDialog"
          }, 
          {
            "label": "删除", 
            "type": "danger", 
            "action": "deleteItem"
          }, 
          {
            "type": "switch", 
            "key": "is_valid", 
            "labels": {
              "0": "上线", 
              "1": "下线"
            }, 
            "actions": {
              "default": "switchStatus"
            }
          }
        ]
      }
    ], 
    "data": [ ]
  }, 
  "page": {
    "data": {
      "total": 0, 
      "current": 1, 
      "size": 20
    }, 
    "action": "retrieve"
  }, 
  "dialogs": {
    "update": {
      "title": "编辑讲者", 
      "items": [
        "name", 
        "avatar_url", 
        "cover", 
        "ranking", 
        "speechcategory", 
        "scene_type", 
        "periods", 
        "intro", 
        "quotations", 
        "describe"
      ], 
      "values": { }, 
      "data": { }, 
      "action": "update", 
      "visible": false
    }, 
    "create": {
      "title": "新建讲者", 
      "items": [
        "name", 
        "avatar_url", 
        "cover", 
        "ranking", 
        "speechcategory", 
        "scene_type", 
        "periods", 
        "intro", 
        "quotations", 
        "describe"
      ], 
      "values": {
        "name": "", 
        "avatar_url": "", 
        "cover": "", 
        "ranking": 0, 
        "speechcategory": "", 
        "scene_type": "", 
        "periods": 0, 
        "intro": "", 
        "quotations": "", 
        "describe": ""
      }, 
      "data": { }, 
      "action": "create", 
      "visible": false
    }
  }, 
  "apis": {
    "meta": {
      "flows": [
        {
          "name": "retrieve",
          "type": "api",
          "url": "category/drop/", 
          "method": "GET",
          "client_config": {
            "meta.speechcategory.options": "data.items"
          }
        },
        {
          "name": "function/options",
          "type": "function",
          "request": "meta.speechcategory.options"
        }
      ]
    },
    "showCreateDialog": {
      "flows": [
        {
          "name": "common",
          "type": "base",
          "client_config": {
            "dialogs.create.visible": true
          }
        }
      ]
    }, 
    "showUpdateDialog": {
      "flows": [
         {
          "name": "common",
          "type": "base",
          "client_config": {
            "dialogs.update.visible": true
          }
         },
         {
          "name": "retrieve",
          "type": "api",
          "url": "speaker/{id}/edit/", 
          "method": "GET",
          "client_config": {
            "dialogs.update.values": "data",
            "dialogs.update.values.avatar_url": "data.avatar"
          }
         }
       ]
    }, 
    "retrieve": {
      "flows": [
        {
          "name": "retrieve",
          "type": "api",
          "request": {
            "page": "page.data.current", 
            "page_size": "page.data.size", 
            "param_name": "filter.values.name", 
            "param_status": "filter.values.is_valid"
          }, 
          "url": "speaker/", 
          "method": "GET",
          "client_config": {
            "table.data": "data.items", 
            "page.data.total": "data.total", 
            "page.data.current": "data.page", 
            "page.data.size": "data.page_size"
          }
         }
      ]
    }, 
    "create": {
      "flows": [
        {
          "name": "common",
          "type": "base",
          "request": {
            "page.data.current": 1,
            "filter.values.name": "",
            "filter.values.is_valid": ""
          }
        },
        {
          "name": "function/values",
          "type": "function",
          "request": "dialogs.create.values"
         },
        {
          "name": "update",
          "type": "api",
          "request": "dialog.create.values", 
          "url": "speaker/create/", 
          "method": "POST"
         }
      ],
      "next": [{
        "action": "retrieve"
      }]
    }, 
    "update": {
      "flows": [{
        "name": "function/values",
        "type": "function",
        "request": "dialogs.update.values"
       }, 
       {
        "name": "update", 
        "type": "api",
        "request": "dialog.create.values", 
        "url": "speaker/{id}/up/", 
        "method": "GET", 
        "client_config": {
          "dialogs.update.data": "dialogs.update.values" 
        }
      }]
    }, 
    "upHandler": {
      "flows": [{
        "name": "update", 
        "type": "api",
        "url": "speaker/{id}/up/", 
        "method": "GET" 
      }],
      "next": [{
        "action": "retrieve"
      }]
    }, 
    "downHandler": {
      "flows": [{
        "name": "update", 
        "type": "api",
        "url": "speaker/{id}/down/", 
        "method": "GET" 
      }],
      "next": [{
        "action": "retrieve"
      }]
    }, 
    "deleteItem": {
      "flows": [{
        "name": "update", 
        "type": "api",
        "url": "speaker/{id}/delete/", 
        "method": "GET" 
      }],
      "next": [{
        "action": "retrieve"
      }]
    }, 
    "switchStatus": {
      "flows": [{
        "name": "update", 
        "type": "api",
        "url": "speaker/{id}/check_status/", 
        "method": "GET" 
      }],
      "next": [{
        "action": "retrieve"
      }]
    }
  }
}